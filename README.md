# Сервис аренды вещей

Сервис для шеринга вещей, который позволяет пользователям брать в аренду нужные предметы и сдавать в аренду свои собственные.

## Функциональность

### Управление пользователями
- Создание пользователя
- Получение пользователя по ID
- Обновление данных пользователя
- Удаление пользователя
- Получение списка всех пользователей

### Управление вещами (Items)
- Добавление новой вещи
- Обновление информации о вещи
- Получение вещи по ID
- Получение всех вещей владельца
- Поиск вещей по тексту (в названии и описании)
- Добавление комментариев к вещам

### Система бронирования
- Создание бронирования
- Подтверждение/отклонение бронирования владельцем
- Получение всех бронирований пользователя
- Получение всех бронирований для вещей владельца
- Получение бронирования по ID

### Система запросов
- Создание запроса на аренду вещи
- Получение запроса по ID
- Получение запросов пользователя с ответами
- Получение запросов других пользователей

## Технологии

- **Java 11**
- **Spring Boot** - основной фреймворк
- **Hibernate** - ORM для работы с базой данных
- **Maven** - управление зависимостями
- **Lombok** - сокращение шаблонного кода
- **PostgreSQL** - основная база данных
- **H2** - база данных для тестирования

## Архитектура приложения

Приложение использует микросервисную архитектуру с разделением на:
- **Gateway** - шлюз для обработки входящих запросов
- **Server** - основной сервер с бизнес-логикой

## Запуск приложения

### Способ 1: Docker Compose
```bash
docker-compose up
```

### Способ 2: IntelliJ IDEA
1. **Запуск server:**
   - `server/src/main/java/ru/practicum/shareit/ShareItServer` → "run"

2. **Запуск gateway:**
   - `gateway/src/main/java/ru/practicum/shareit/ShareItGateway` → "run"

## API Endpoints

### Пользователи
- `POST /users` - создание пользователя
- `GET /users/{id}` - получение пользователя по ID
- `PATCH /users/{id}` - обновление пользователя
- `DELETE /users/{id}` - удаление пользователя
- `GET /users` - список всех пользователей

### Вещи
- `POST /items` - добавление вещи
- `PATCH /items/{id}` - обновление вещи
- `GET /items/{id}` - получение вещи по ID
- `GET /items` - вещи владельца
- `GET /items/search?text={query}` - поиск вещей
- `POST /items/{itemId}/comment` - добавление комментария

### Бронирования
- `POST /bookings` - создание бронирования
- `PATCH /bookings/{bookingId}?approved={true/false}` - подтверждение бронирования
- `GET /bookings/{bookingId}` - получение бронирования по ID
- `GET /bookings` - бронирования пользователя
- `GET /bookings/owner` - бронирования вещей владельца

### Запросы
- `POST /requests` - создание запроса
- `GET /requests/{id}` - получение запроса по ID
- `GET /requests` - запросы пользователя
- `GET /requests/all` - запросы других пользователей

## Заголовки запросов

Для аутентификации используется заголовок:
- `X-Sharer-User-Id` - ID пользователя

## Бизнес-правила

### Валидация пользователей:
- Email должен быть уникальным и валидным
- Имя не может быть пустым

### Валидация вещей:
- Название не может быть пустым
- Описание не может быть пустым
- Доступность должна быть указана

### Валидация бронирований:
- Дата начала не может быть в прошлом
- Дата окончания должна быть после даты начала
- Нельзя бронировать собственную вещь
- Можно бронировать только доступные вещи

### Валидация комментариев:
- Можно оставлять комментарии только после завершенного бронирования
- Только арендатор может оставлять комментарии

## Тестирование

В проекте предоставлена коллекция Postman для тестирования всех endpoints, включая:
- Тесты создания и валидации пользователей
- Тесты управления вещами
- Тесты системы бронирования
- Тесты обработки запросов
- Тесты комментариев
- Тесты обработки ошибок

Для запуска тестов используйте предоставленную коллекцию Postman с предварительно настроенными переменными.

## Структура базы данных

Приложение использует реляционную базу данных со следующими основными сущностями:
- **users** - пользователи
- **items** - вещи
- **bookings** - бронирования
- **requests** - запросы
- **comments** - комментарии

---

ShareIt предоставляет полнофункциональную платформу для шеринга вещей с системой бронирования, управления доступностью и системой отзывов для обеспечения доверия между пользователями.
